<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Bin Day Brewing — In Memory</title>

  <!-- Favicon -->
  <link rel="icon" type="image/png" href="favicon.ico">

  <!-- Firebase (compat version) -->
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>

  <style>
    :root {
      --bg-color: #f8f8f8;
      --text-color: #222;
      --accent-color: #000000;
      --light-color: #ffffff;
    }

    body {
      margin: 0;
      padding: 0;
      background: var(--bg-color);
      color: var(--text-color);
      font-family: "Segoe UI", Roboto, Arial, sans-serif;
      line-height: 1.6;
    }

    .header {
      background: var(--accent-color);
      color: var(--light-color);
      text-align: center;
      padding: 60px 20px;
    }

    .header h1 {
      margin: 0;
      font-size: 2.4rem;
      letter-spacing: 1px;
      font-weight: 700;
    }

    .header p {
      margin: 10px 0 0;
      font-size: 1.1rem;
      opacity: 0.85;
    }

    .container {
      max-width: 900px;
      margin: 0 auto;
      padding: 30px 20px;
    }

    .gallery {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 20px;
      margin: 40px 0;
    }

    .gallery img {
      width: 100%;
      height: 220px;
      object-fit: cover;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
      background: #ddd;
    }

    .bio h2,
    .tribute h2,
    #game-section h2,
    #leaderboard-section h2,
    #comments-section h2 {
      margin-top: 40px;
      border-bottom: 2px solid #000;
      padding-bottom: 8px;
      text-align: center;
    }

    .footer {
      text-align: center;
      padding: 20px;
      font-size: 0.9rem;
      color: #666;
      margin-top: 40px;
    }

    .top-logo {
      position: absolute;
      top: 20px;
      left: 20px;
      z-index: 999;
    }

    .top-logo img {
      height: 60px;
      width: auto;
      filter: drop-shadow(0 2px 4px rgba(0,0,0,0.3));
    }

    #game-container {
      width: 400px;
      height: 600px;
      background: #eee;
      margin: 20px auto 40px;
      position: relative;
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 4px 12px rgba(0,0,0,0.2);
    }

    #player {
      width: 60px;
      height: 60px;
      background: #222;
      border-radius: 50%;
      position: absolute;
      bottom: 10px;
      left: 170px;
    }

    .beer-can {
      width: 40px;
      height: 60px;
      background: gold;
      border: 3px solid #8a6b00;
      border-radius: 6px;
      position: absolute;
      top: -60px;
    }

    #score {
      position: absolute;
      top: 10px;
      left: 10px;
      font-weight: bold;
      font-size: 1.1rem;
      color: #333;
    }

    #comments-list div {
      padding: 10px;
      border-bottom: 1px solid #ddd;
    }
  </style>
</head>
<body>

<div class="top-logo">
  <img src="bindaybrewing1.jpg" alt="Bin Day Brewing Logo">
</div>

<header class="header">
  <h1>In Memory of BIN DAY BREWING</h1>
  <p>Founded by Robbie Knox — A passion project to be remembered</p>
</header>

<div class="container">

  <section class="gallery">
    <img src="bindaybrewing.jpg" alt="Bin Day Brewing Logo">
    <img src="bindayglass.jpg" alt="Bin Day Brewing glass">
    <img src="rollwithit.jpg" alt="Roll With It beer">
    <img src="themockup.jpg" alt="Can mockup artwork">
  </section>

  <section class="bio">
    <h2>About Bin Day Brewing</h2>
    <p>
      Bin Day Brewing began as a humble lockdown-era project between Robbie Knox and a friend —
      starting from beer kits brewed at home and eventually growing into an official business.
    </p>
    <p>
      Their vision was simple: craft beers made with passion, humour, and heart.
      Though the brewery has since closed, what it represented deserves a legacy.
    </p>
  </section>

  <section class="tribute">
    <h2>Remembering the Spirit</h2>
    <p>
      For many, Bin Day Brewing wasn’t just a beer brand — it was a spark during difficult times,
      an idea that made people smile, and a project that captured imagination.
    </p>
    <p>I was too young to try it myself, but I wish I could've.</p>
    <p><em>“Gone, but not forgotten.”</em></p>
  </section>

  <!-- GAME WITH PAUSE BUTTON -->
  <section id="game-section">
    <h2 style="text-align:center;">
      Catch the Beer Cans
      <button id="pauseBtn"
        style="margin-left:10px;padding:6px 14px;font-size:0.9rem;cursor:pointer;">
        Pause
      </button>
    </h2>

    <div id="game-container">
      <div id="player"></div>
      <div id="score">Score: 0</div>
    </div>
  </section>

  <section id="leaderboard-section">
    <h2>Global Leaderboard</h2>
    <div id="leaderboard-list" style="max-width:400px;margin:0 auto;text-align:center;">
      Loading leaderboard...
    </div>
  </section>

  <section id="comments-section">
    <h2>Community Comments</h2>

    <div style="max-width:600px;margin:20px auto;text-align:center;">
      <input id="comment-name" placeholder="Your name"
             style="padding:10px;width:45%;margin:5px;">
      <input id="comment-text" placeholder="Your comment..."
             style="padding:10px;width:45%;margin:5px;">
      <button onclick="submitComment()"
              style="padding:10px 20px;margin-top:10px;">Post</button>
    </div>

    <div id="comments-list"
         style="max-width:600px;margin:20px auto;padding:10px;background:#fff;
                border-radius:8px;box-shadow:0 4px 12px rgba(0,0,0,0.1);">
      Loading comments...
    </div>
  </section>

</div>

<footer class="footer">
  This tribute page was created in appreciation of Bin Day Brewing and the impact it had.
</footer>

<script>
/* Firebase config */
const firebaseConfig = {
  apiKey: "AIzaSyAumyoE9xkHP6ybY0O_52-O8Ro7OBbHjtg",
  authDomain: "bin-day-brewing.firebaseapp.com",
  databaseURL: "https://bin-day-brewing-default-rtdb.firebaseio.com",
  projectId: "bin-day-brewing",
  storageBucket: "bin-day-brewing.firebasestorage.app",
  messagingSenderId: "540124499398",
  appId: "1:540124499398:web:9f053c28d0d4d7df9c36c7"
};

firebase.initializeApp(firebaseConfig);
const db = firebase.database();

/* ==== GAME VARIABLES ==== */
let player = null;
let playerX = 170;
let score = 0;
let paused = false;

/* ==== START GAME ==== */
function startGame() {
  player = document.getElementById("player");
  document.addEventListener("keydown", movePlayer);
  spawnBeerCan();
}

/* ==== PAUSE ==== */
document.getElementById("pauseBtn").onclick = function () {
  paused = !paused;
  this.innerText = paused ? "Resume" : "Pause";
};

function movePlayer(e) {
  if (paused) return;

  const speed = 20;
  if (e.key === "ArrowLeft" || e.key === "a") playerX -= speed;
  if (e.key === "ArrowRight" || e.key === "d") playerX += speed;

  playerX = Math.max(0, Math.min(340, playerX));
  player.style.left = playerX + "px";
}

/* ==== FALLING CAN ==== */
function spawnBeerCan() {
  const container = document.getElementById("game-container");
  const can = document.createElement("div");
  can.classList.add("beer-can");
  can.style.left = Math.floor(Math.random() * 350) + "px";
  container.appendChild(can);

  let canY = -60;
  const fallSpeed = 3;

  const fallInterval = setInterval(() => {
    if (paused) return;

    canY += fallSpeed;
    can.style.top = canY + "px";

    if (canY > 530) {
      const canX = parseInt(can.style.left);

      if (Math.abs(canX - playerX) < 50) {
        score++;
        document.getElementById("score").innerText = "Score: " + score;
        can.remove();
        clearInterval(fallInterval);
        spawnBeerCan();
      } else {
        clearInterval(fallInterval);
        can.style.background = "red";
        finishGame();
      }
    }
  }, 10);
}

/* ==== GAME OVER ==== */
function finishGame() {
  let name = prompt("Game Over! Score: " + score + "\nEnter your name:");
  if (!name) name = "Anonymous";

  saveScore(name, score);

  score = 0;
  document.getElementById("score").innerText = "Score: 0";

  document.querySelectorAll(".beer-can").forEach(e => e.remove());
  setTimeout(spawnBeerCan, 500);
}

/* ==== FIXED SAVE (FORCES NUMBER) ==== */
function saveScore(name, score) {
  db.ref("leaderboard").push({
    name: name,
    score: Number(score),
    timestamp: Date.now()
  });
}

/* ==== FIXED LOAD (MANUAL SORTING) ==== */
function loadLeaderboard() {
  db.ref("leaderboard").on("value", snap => {

    let rows = [];
    snap.forEach(child => rows.push(child.val()));

    // sort highest → lowest
    rows.sort((a, b) => b.score - a.score);

    // top 10
    rows = rows.slice(0, 10);

    let html = "<h3>Top 10 Scores</h3>";

    rows.forEach(entry => {
      html += `<div style="padding:6px;">${entry.name}: <b>${entry.score}</b></div>`;
    });

    document.getElementById("leaderboard-list").innerHTML = html;
  });
}

/* ==== COMMENTS ==== */
function submitComment() {
  const name = document.getElementById("comment-name").value.trim();
  const text = document.getElementById("comment-text").value.trim();

  if (!name || !text) {
    alert("Please enter both name and comment!");
    return;
  }

  db.ref("comments").push({
    name: name,
    text: text,
    timestamp: Date.now()
  });

  document.getElementById("comment-text").value = "";
}

function loadComments() {
  db.ref("comments")
    .limitToLast(50)
    .on("value", snap => {
      let html = "";
      snap.forEach(child => {
        let c = child.val();
        html += `
          <div>
            <b>${c.name}</b><br>
            ${c.text}
          </div>
        `;
      });
      document.getElementById("comments-list").innerHTML = html;
    });
}

/* ==== INIT ==== */
window.onload = function() {
  startGame();
  loadLeaderboard();
  loadComments();
};
</script>

</body>
</html>
